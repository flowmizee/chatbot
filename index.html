<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
    <title>Chat Web Estilo WhatsApp</title>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.12.313/pdf.min.js"></script>
    
    <style>
      html, body {
        margin: 0;
        padding: 0;
        font-family: 'Segoe UI', sans-serif;
        height: 100%;
        background-color: #ece5dd;
      }
      body {
        display: flex;
        justify-content: center;
        align-items: center;
      }
      .chat-container {
        width: 100%;
        height: 100dvh;
        max-width: 430px;
        background-color: #fff;
        display: flex;
        flex-direction: column;
        box-shadow: 0 0 10px rgba(0,0,0,0.2);
        position: relative;
      }
      .chat-header {
        background-color: #075E54;
        padding: 10px 15px;
        display: flex;
        align-items: center;
        color: white;
      }
      .chat-header img {
        width: 45px;
        height: 45px;
        border-radius: 50%;
        margin-right: 12px;
        object-fit: cover;
      }
      .chat-header .name {
        font-size: 18px;
        font-weight: bold;
      }
      .chat-body {
        flex: 1;
        padding: 15px;
        overflow-y: auto;
        background-color: #e5ddd5;
        display: flex;
        flex-direction: column;
      }
      .message {
        max-width: 75%;
        padding: 10px 14px;
        margin-bottom: 8px;
        font-size: 15px;
        border-radius: 8px;
        line-height: 1.4;
        word-wrap: break-word;
      }
      .user {
        align-self: flex-end;
        background-color: #dcf8c6;
        border-bottom-right-radius: 0;
      }
      .bot {
        align-self: flex-start;
        background-color: white;
        border-bottom-left-radius: 0;
      }
      .typing-indicator {
        align-self: flex-start;
        background-color: white;
        border-bottom-left-radius: 0;
        max-width: 50px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        margin-bottom: 8px;
        padding: 5px 10px;
      }
      .typing-indicator span {
        display: inline-block;
        width: 6px;
        height: 6px;
        margin: 0 1px;
        background-color: #999;
        border-radius: 50%;
        animation: blink 1.4s infinite both;
      }
      .typing-indicator span:nth-child(2) {
        animation-delay: 0.2s;
      }
      .typing-indicator span:nth-child(3) {
        animation-delay: 0.4s;
      }
      @keyframes blink {
        0%, 80%, 100% { opacity: 0; }
        40% { opacity: 1; }
      }
      .chat-footer {
        display: flex;
        padding: 8px 10px;
        background-color: #fff;
        border-top: 1px solid #ccc;
        align-items: center;
        position: relative;
      }
      .chat-footer input {
        flex: 1;
        padding: 12px;
        border: none;
        font-size: 16px;
        border-radius: 20px;
        margin-right: 8px;
        background-color: #f0f0f0;
        outline: none;
        padding-left: 40px;
      }
      .chat-footer button#actionButton {
        width: 40px;
        height: 40px;
        background-color: #1bac5f;
        border: none;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
      }
      .chat-footer button#actionButton img {
        width: 20px;
        height: 20px;
      }
      .option-buttons {
        display: flex;
        gap: 10px;
        margin-top: 10px;
        flex-wrap: wrap;
      }
      .option-button {
        background-color: #075E54;
        color: white;
        border: none;
        padding: 8px 12px;
        border-radius: 20px;
        cursor: pointer;
        font-size: 14px;
      }
      .option-button:hover {
        background-color: #0b7a67;
      }
      .preview-image {
        max-width: 100%;
        border-radius: 8px;
        margin-top: 10px;
      }
      .buy-button {
        background-color: #25D366;
        color: white;
        border: none;
        padding: 12px 20px;
        border-radius: 20px;
        cursor: pointer;
        font-size: 16px;
        font-weight: bold;
        margin-top: 15px;
        display: inline-block;
        width: 100%;
        text-align: center;
      }
      .buy-button:hover {
        background-color: #128C7E;
      }
      .testimonial-image {
        max-width: 100%;
        border-radius: 8px;
        margin-top: 10px;
        border: 2px solid #075E54;
      }
      .profile-image {
        max-width: 200px;
        border-radius: 8px;
        margin-top: 10px;
        border: 2px solid #075E54;
      }
      .upload-label {
        display: inline-block;
        padding: 10px 15px;
        background-color: #075E54;
        color: white;
        border-radius: 20px;
        cursor: pointer;
        margin-top: 10px;
        margin-right: 10px;
      }
      #uploadComprovanteFoto, #uploadComprovantePDF {
        display: none;
      }
      .pix-info {
        background-color: #f0f0f0;
        padding: 15px;
        border-radius: 10px;
        margin-top: 15px;
      }
      .pix-info p {
        margin: 5px 0;
      }
      .pix-info strong {
        color: #075E54;
      }
      .comprovante-container {
        margin-top: 15px;
      }
      .comprovante-preview {
        max-width: 100%;
        max-height: 200px;
        border-radius: 8px;
        margin-top: 10px;
        border: 1px solid #ccc;
      }
      .success-message {
        color: #25D366;
        font-weight: bold;
        margin-top: 10px;
      }
      .error-message {
        color: #f44336;
        font-weight: bold;
        margin-top: 10px;
      }
      .pdf-warning {
        background-color: #fff3cd;
        color: #856404;
        padding: 10px;
        border-radius: 5px;
        margin-top: 10px;
        font-size: 14px;
      }
      .upload-buttons {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 10px;
      }
      /* NOVO ESTILO DO √ÅUDIO - IGUAL AO WHATSAPP */
      .audio-message {
        display: flex;
        align-items: center;
        background-color: white;
        padding: 10px 15px;
        border-radius: 15px;
        margin-bottom: 8px;
        max-width: 300px;
        width: 250px;
      }
      .audio-message .play-button {
        width: 30px;
        height: 30px;
        background-color: #25D366;
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        margin-right: 10px;
        cursor: pointer;
      }
      .audio-message .play-button.playing {
        background-color: #f44336;
      }
      .audio-message .play-button::after {
        content: '';
        width: 0;
        height: 0;
        border-top: 7px solid transparent;
        border-left: 12px solid white;
        border-bottom: 7px solid transparent;
        margin-left: 2px;
      }
      .audio-message .play-button.playing::after {
        content: '';
        width: 10px;
        height: 10px;
        background-color: white;
        border: none;
      }
      .audio-message .audio-info {
        flex: 1;
      }
      .audio-message .audio-wave {
        display: flex;
        align-items: center;
        height: 30px;
        width: 100%;
      }
      .audio-message .audio-wave span {
        display: inline-block;
        width: 2px;
        margin-right: 1px;
        background-color: #075E54;
        border-radius: 2px;
      }
      .bot-recording-indicator {
        background-color: white;
        padding: 8px 12px;
        border-radius: 8px;
        margin-bottom: 8px;
        align-self: flex-start;
        max-width: 40px;
        position: relative;
        box-shadow: 0 1px 1px rgba(0,0,0,0.1);
      }
      .bot-recording-indicator::after {
        content: '';
        position: absolute;
        left: -8px;
        top: 8px;
        width: 0;
        height: 0;
        border-top: 8px solid transparent;
        border-right: 8px solid white;
        border-bottom: 8px solid transparent;
      }
      .bot-recording-img {
        width: 32px;
        height: 32px;
        animation: pulse 1.5s infinite ease-in-out;
      }
      .user-recording-indicator {
        position: absolute;
        left: 35px;
        display: flex;
        align-items: center;
      }
      .user-recording-img {
        width: 24px;
        height: 24px;
        margin-right: 8px;
        animation: pulse 1.5s infinite ease-in-out;
      }
      .user-recording-time {
        font-size: 14px;
        color: #555;
        position: absolute;
        left: 45px;
        top: 50%;
        transform: translateY(-50%);
        pointer-events: none;
      }
      @keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.3; }
      }
      .mic-icon {
        position: absolute;
        left: 15px;
        width: 24px;
        height: 24px;
        cursor: pointer;
        animation: pulse 1.5s infinite ease-in-out;
        display: none;
        top: 50%;
        transform: translateY(-50%);
        pointer-events: none;
      }
    </style>
  </head>
  <body>
    <div class="chat-container">
      <div class="chat-header">
        <img src="perfil.webp" alt="Perfil">
        <div class="name"><strong>Larissa Campos</strong></div>
      </div>
      <div class="chat-body" id="chatBody"></div>
      <div class="chat-footer">
        <img src="gravaperson.webp" alt="Gravar" class="mic-icon" id="micIcon">
        <span class="user-recording-time" id="recordingTime" style="display: none;">0:00</span>
        <input type="text" id="userInput" placeholder="Digite sua mensagem..." oninput="updateActionIcon()" onkeypress="handleKeyPress(event)">
        <button id="actionButton" title="Gravar ou enviar">
          <img id="actionIcon" src="gravacao.webp" alt="√çcone">
        </button>
      </div>
    </div>

    <script type="text/javascript">
      (function(c,l,a,r,i,t,y){
          c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
          t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
          y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
      })(window, document, "clarity", "script", "s28w44cz1e");
    </script>

    <script>
      // Configura√ß√£o do PDF.js
      pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.12.313/pdf.worker.min.js';
      
      const GEMINI_API_KEY = 'AIzaSyBZWq79odwHX5NnccXU_1Y9_SSYAAuPg3Q';
      const GEMINI_URL = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent';
      const PIX_KEY = '98981420070';
      const RECEIVER_NAME = 'Antonio Renimar Pinheiro Almeida';
      const RECEIVER_KEYWORDS = ['antonio', 'renimar', 'pinheiro', 'almeida'];
      const EBOOK_BASICO_LINK = 'https://drive.google.com/drive/folders/1v86_qVHA61RQR8X1gtAv3xaxSxKnwvXb';
      const EBOOK_COMPLETO_LINK = 'https://drive.google.com/drive/folders/1vAot8BBYUrWqPvYeCYUVMcvQxAybNTmF';
      const WHATSAPP_LARISSA = '98981507823';
      const GRUPO_WHATSAPP = 'https://chat.whatsapp.com/HgZNILSst31K2pQSXWiAAp';
      const RECEITA_GRATIS_LINK = 'https://drive.google.com/drive/folders/10dhKX4lN2eTHxDsCWycopeeLFTyYBW5M';
      const APP_SCRIPT_URL = ''; // URL do Google Apps Script ser√° inserida aqui
      
      let isWaitingResponse = false;
      let typingEl = null;
      let conversationStage = 0;
      let currentPackage = 'basico';
      let lastOptionSelected = null;
      let shownBasicoDetails = false;
      let shownCompletoDetails = false;
      let isWaitingPayment = false;
      let uploadedComprovante = null;
      let comprovanteUploaded = false;
      let isWaitingWhatsappNumber = false;
      let activeAudio = null;
      let audioEndListener = null;
      let recordingStartTime = null;
      let recordingTimer = null;

      // √Åudios de agradecimento
      const audioAgradecimento1 = new Audio('agradecimento1.mp3');
      const audioAgradecimento2 = new Audio('agradecimento2.mp3');

      // Configurar os √°udios
      function setupAudios() {
        [audioAgradecimento1, audioAgradecimento2].forEach(audio => {
          audio.addEventListener('play', function() {
            // Pausar qualquer √°udio que esteja tocando
            if (activeAudio && activeAudio !== this) {
              activeAudio.pause();
              const playButtons = document.querySelectorAll('.play-button');
              playButtons.forEach(btn => btn.classList.remove('playing'));
            }
            activeAudio = this;
            
            // Atualizar o bot√£o de play correspondente
            const audioElements = document.querySelectorAll('audio');
            for (let audioEl of audioElements) {
              if (audioEl.src === this.src) {
                const playButton = audioEl.parentElement.querySelector('.play-button');
                if (playButton) playButton.classList.add('playing');
                break;
              }
            }
          });
          
          audio.addEventListener('ended', function() {
            const audioElements = document.querySelectorAll('audio');
            for (let audioEl of audioElements) {
              if (audioEl.src === this.src) {
                const playButton = audioEl.parentElement.querySelector('.play-button');
                if (playButton) playButton.classList.remove('playing');
                break;
              }
            }
            if (audioEndListener) { 
              audioEndListener(); 
              audioEndListener = null; 
            }
          });
          
          audio.addEventListener('pause', function() {
            const audioElements = document.querySelectorAll('audio');
            for (let audioEl of audioElements) {
              if (audioEl.src === this.src) {
                const playButton = audioEl.parentElement.querySelector('.play-button');
                if (playButton) playButton.classList.remove('playing');
                break;
              }
            }
          });
        });
      }

      // Fun√ß√£o para alternar play/pause do √°udio
      function toggleAudio(button) {
        const audio = button.parentElement.querySelector('audio');
        if (!audio) return;
        
        if (audio.paused) {
          audio.play().catch(e => console.log("Erro ao reproduzir √°udio:", e));
          button.classList.add('playing');
        } else {
          audio.pause();
          button.classList.remove('playing');
        }
      }

      // Web Speech API para grava√ß√£o de voz
      let recognition;
      const actionButton = document.getElementById('actionButton');
      const actionIcon = document.getElementById('actionIcon');
      const userInput = document.getElementById('userInput');
      const micIcon = document.getElementById('micIcon');
      const recordingTime = document.getElementById('recordingTime');

      if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        recognition = new SpeechRecognition();
        recognition.lang = 'pt-BR';
        recognition.continuous = false;
        recognition.interimResults = false;
        recognition.onstart = () => {
          startRecordingUI();
          recordingStartTime = new Date();
          updateRecordingTime();
        };
        recognition.onend = () => {
          stopRecordingUI();
          if (recordingTimer) {
            clearInterval(recordingTimer);
            recordingTimer = null;
          }
        };
        recognition.onresult = (event) => {
          const transcript = event.results[0][0].transcript;
          userInput.value = transcript;
          updateActionIcon();
          sendMessage();
        };
      }

      function startRecordingUI() {
        micIcon.style.display = 'block';
        recordingTime.style.display = 'block';
        userInput.placeholder = '';
      }

      function stopRecordingUI() {
        micIcon.style.display = 'none';
        recordingTime.style.display = 'none';
        userInput.placeholder = 'Digite sua mensagem...';
      }

      function updateRecordingTime() {
        recordingTimer = setInterval(() => {
          const now = new Date();
          const elapsed = Math.floor((now - recordingStartTime) / 1000);
          const minutes = Math.floor(elapsed / 60);
          const seconds = elapsed % 60;
          recordingTime.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
        }, 1000);
      }

      actionButton.addEventListener('click', () => {
        if (userInput.value.trim()) {
          sendMessage();
        } else if (recognition) {
          try {
            recognition.start();
          } catch (e) {}
        }
      });

      function updateActionIcon() {
        if (userInput.value.trim()) {
          actionIcon.src = 'mensagem.webp';
        } else {
          actionIcon.src = 'gravacao.webp';
        }
      }

      function buildSystemPrompt(userMessage) {
        let prompt = `Voc√™ √© a Chef Larissa Campos, chef e nutricionista especializada em receitas sem gl√∫ten e sem lactose. Responda sempre em primeira pessoa do singular (eu), de forma direta, simp√°tica, confiante, acolhedora e com leve carisma. Nunca use cumprimentos como "oi" ou "oi, tudo bem?". Use respostas curtas, claras e completas, sem omitir o essencial. N√£o inclua chamadas de a√ß√£o textuais redundantes como "üåü Quero o Pacote Completo" no texto, pois os bot√µes aparecem abaixo. Incentive a compra de forma natural, ex: "Se quiser, posso te enviar o link agora mesmo üòä". 
        
Importante: Eu n√£o aceito pagamento parcelado por j√° ser um valor de baixo custo e promocional. Aceito apenas PIX √† vista.

Sobre mim: Sou nutricionista e chef de Florian√≥polis (SC). Minha paix√£o pela cozinha come√ßou por amor ‚Äî amor pela minha m√£e, que tem intoler√¢ncia √† lactose, e pelo meu irm√£o, que √© cel√≠aco. Crio receitas sem gl√∫ten e sem lactose que sejam simples, gostosas e acolhedoras, para ajudar pessoas a redescobrirem o prazer de comer bem.

Use como base todas as informa√ß√µes de receitas, formatos, formas de pagamento, suporte, b√¥nus, diferenciais etc. abaixo para adaptar respostas, respondendo sem repeti√ß√µes finais redundantes.

1. Receitas: exemplos como P√£o de Frigideira, Vapt-Vupt, Hamb√∫rguer, Vegano, Castanhas, Mandioquinha com Chia, Am√™ndoas, Cenoura, Baguete, Batata Doce de Micro-ondas. Divididas entre e-books, b√¥nus s√≥ ap√≥s compra. Todas sem gl√∫ten e sem lactose. Muitas veganas, substitui√ß√µes ensinadas. B√¥nus de doces sem a√ß√∫car para diab√©ticos no pacote completo. Ingredientes acess√≠veis. Ebook 50 receitas (~80 p√°gs); Guia 125 receitas (>200 p√°gs). Fotos prontas. Salgadas e doces. R√°pidas (<30 min). Medidas em x√≠caras e gramas. Substitutos para ovos/alerg√™nicos. B√¥nus "Bolos Sem Gl√∫ten" para festas. Algumas op√ß√µes low-carb no completo. Fermenta√ß√£o natural em b√¥nus. Variedade: p√£es, bolos, biscoitos, salgados.

2. Qualidade: testadas por mim (chef nutricionista). Garantia de reembolso 7 dias. Depoimentos reais. Forma√ß√£o em Nutri√ß√£o. Pr√©via poss√≠vel via Instagram/WhatsApp.

3. Compra: B√°sico R$9,90, Completo R$19,90. Sem desconto extra. Apenas PIX √† vista.

4. Entrega e suporte: acesso em minutos ap√≥s confirma√ß√£o do pagamento. Envio direto no chat; posso reenviar via WhatsApp. Suporte via WhatsApp comigo; no completo, tamb√©m comunidade exclusiva.

5. Formato: digital PDF, baixar, imprimir, acessar no celular. Atualiza√ß√µes futuras sem custo. Compartilhamento restrito a uso dom√©stico.

6. Dificuldade: explica√ß√µes claras para iniciantes. Utens√≠lios comuns; algumas receitas usam mixer, mas sempre op√ß√µes simples. R√°pidas e op√ß√µes para airfryer/panela press√£o.

7. Benef√≠cios: testadas por chef nutricionista, fotos, explica√ß√µes. Economia de tempo, evita frustra√ß√µes. Dicas e segredos de chef. Suporte confi√°vel.

8. Compara√ß√£o: B√°sico = 50 receitas, sem comunidade. Completo = 125 receitas + 6 b√¥nus + comunidade + suporte extra. Suporte diferenciado com comunidade no completo.

9. Restri√ß√µes: op√ß√µes sem ovo, sem soja, substitui√ß√µes para nozes, adapta√ß√µes FODMAP. Ado√ßantes naturais.

10. Sobre Larissa: nutricionista formada, chef com ~6 anos. Redes sociais: Instagram @receitinhasdalari, Facebook link fornecido. Objetivo: ajudar a comer bem sem gl√∫ten/lactose.

11. T√©cnicas: uso de goma xantana/psyllium com explica√ß√£o. Blends de farinhas, tabelas de equival√™ncia, fun√ß√£o de ingredientes.

12. B√¥nus e promo√ß√µes: pacote completo inclui 6 b√¥nus. Pre√ßo promocional atual, sem cupons extras. B√¥nus liberados por tempo limitado.

Regras de bot√µes:
- Interesse claro em "50 Receitas": envie dois bot√µes: "‚úÖ Comprar 50 Receitas" e "üåü Quero o Pacote Completo".
- Interesse direto no pacote completo: envie apenas "üåü Quero o Pacote Completo".
- N√£o envie bot√µes se n√£o houver interesse expl√≠cito.
- Se trocar de ideia, ajuste bot√µes conforme novo interesse.
- Use pequena pausa (1-2s) antes de "gravar" ou digitar resposta.
- Nunca envie textos longos: responda curto e objetivo, sem repeti√ß√µes finais.
- Se pergunta sobre qualidade, ingredientes, tempo, dietas, restri√ß√µes, pre√ßos, formatos, b√¥nus, reembolso, acesso, d√∫vidas t√©cnicas: use as respostas acima adaptadas ao tom.
- Se fora do escopo, responda: "Esse assunto foge um pouco do que eu costumo compartilhar por aqui, mas posso te ajudar com receitas incr√≠veis sem gl√∫ten e sem lactose! üíô"

Contexto: ${lastOptionSelected ? '√∫ltima sele√ß√£o: ' + lastOptionSelected : 'in√≠cio'}.
Cliente: ${userMessage}`;
        return prompt;
      }

      window.onload = async () => {
        setupAudios(); // Configurar os listeners dos √°udios
        
        // Fluxo inicial com as novas mensagens
        await simulateTyping("Oi√™! Eu sou a <strong>Larissa Campos</strong>, nutricionista apaixonada por receitas saud√°veis sem gl√∫ten e sem lactose. üíõü•∞");
        await simulateTyping("üò± Sofre com gl√∫ten ou lactose e nada d√° certo na cozinha? üçû Vem comigo! Voc√™ vai aprender a fazer p√£es incr√≠veis, com ingredientes simples ‚Äî e muito sabor!");
        await simulateTyping("üëá Escolhe uma op√ß√£o:");
        appendMessage("bot", `
          <div class="option-buttons">
            <button class="option-button" onclick="handleOptionClick('As 50 Receitas')">üë©‚Äçüç≥ As 50 Receitas</button>
            <button class="option-button" onclick="handleOptionClick('Me mostra o Pacote Completo')">üéÄ Me mostra o Pacote Completo</button>
            <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
          </div>`);
      };

      async function handleOptionClick(option) {
        appendMessage("user", option);
        lastOptionSelected = option;
        
        if (option === 'As 50 Receitas') {
          currentPackage = 'basico';
          await show50ReceitasFlow();
        } 
        else if (option === 'Me mostra o Pacote Completo') {
          currentPackage = 'completo';
          await showPacoteCompletoFlow();
        }
        else if (option === 'Grupo Gr√°tis no WhatsApp') {
          await simulateTyping("Me manda seu n√∫mero de WhatsApp com DDD (exemplo: 11999999999), que eu vou te colocar no nosso Grupo Free do WhasApp com receitinhas, dicas e conte√∫dos exclusivos. Eles s√£o animadinhos! ü§≠üëáüèª");
          appendMessage("bot", `<img src="grupo.webp" alt="Grupo WhatsApp" class="preview-image">`);
          await simulateTyping("Se preferir n√£o passar agora, t√° tudo bem! Voc√™ pode continuar por aqui mesmo escolhendo uma das op√ß√µes abaixo.");
          
          appendMessage("bot", `
            <div class="option-buttons">
              <button class="option-button" onclick="handleOptionClick('Me mostra o Pacote Completo')">üéÄ Me mostra o Pacote Completo</button>
              <button class="option-button" onclick="handleOptionClick('As 50 Receitas')">üë©‚Äçüç≥ As 50 Receitas</button>
            </div>`);
          
          isWaitingWhatsappNumber = true;
        }
      }

      async function show50ReceitasFlow() {
        await simulateTyping("ü•∞ Que bom que voc√™ escolheu come√ßar com as 50 Receitas Saud√°veis!");
        await simulateTyping("Esse e-book est√° cheio de receitas sem gl√∫ten e sem lactose ‚Äî f√°ceis e deliciosas!");
        await simulateTyping("<strong>‚ú® O que voc√™ vai receber:</strong><br><br>üìò 50 receitas exclusivas<br>‚ùå Sem gl√∫ten e sem lactose<br>üõí Ingredientes f√°ceis de encontrar<br>ü§ù Suporte direto comigo pelo WhatsApp<br>üîí Acesso vital√≠cio<br><br><strong>üî¥ Tudo isso por apenas R$ 9,90!</strong>");
        await simulateTyping("üëá √â s√≥ clicar no bot√£o pra garantir o seu!");
        appendMessage("bot", `
          <div class="option-buttons">
            <button class="option-button" onclick="handleBuyInterest('Garantir as 50 Receitas')">‚úÖ Garantir as 50 Receitas</button>
            <button class="option-button" onclick="handleOptionClick('Me mostra o Pacote Completo')">üéÄ Me mostra o Pacote Completo</button>
            <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
          </div>`);
      }

      async function showPacoteCompletoFlow() {
        await simulateTyping("ü•∞ Claro que sim ü•∞<br>D√° uma olhadinha no que te espera:");
        await simulateTyping("<strong>üìö Pacote Completo ‚Äì R$ 19,90 (promo√ß√£o)</strong><br><br>‚úÖ Guia P√£es Sem Gl√∫ten ‚Äì com 125 receitas testadas<br>‚úÖ Acesso vital√≠cio e direito a todas as atualiza√ß√µes futuras<br>‚úÖ Comunidade exclusiva no WhatsApp<br>‚úÖ Contato direto comigo via WhatsApp");
        await simulateTyping("<strong>üéÅ 6 E-books Extras:</strong><br><br>üç´ Doces sem A√ß√∫car<br><br>üç∞ Bolos Sem Gl√∫ten<br><br>üéÑ Panetone & Chocotone<br><br>ü•ö Substitui√ß√µes de Ingredientes<br><br>ü•ñ P√£es Tran√ßados<br><br>üß™ Fermenta√ß√£o Natural");
        appendMessage("bot", `
          <div class="option-buttons">
            <button class="option-button" onclick="handleBuyInterest('Quero o Pacote Completo')">üéÄ Quero o Pacote Completo</button>
            <button class="option-button" onclick="handleOptionClick('As 50 Receitas')">üë©‚Äçüç≥ As 50 Receitas</button>
            <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
          </div>`);
      }

      const personalizedMessages = {
        basico: [
          "ü•∞ Que escolha maravilhosa! As 50 receitas v√£o transformar sua cozinha!",
          "Voc√™ pode pagar via Pix e enviar o comprovante aqui mesmo üíö",
          "Assim que confirmarmos seu pagamento, seu e-book estar√° dispon√≠vel para download. ‚ò∫Ô∏è"
        ],
        completo: [
          "ü•∞ Excelente decis√£o! O pacote completo vai revolucionar sua alimenta√ß√£o!",
          "Voc√™ pode pagar via Pix e enviar o comprovante aqui mesmo üíö",
          "Assim que confirmarmos seu pagamento, seu acesso ser√° liberado imediatamente. ‚ò∫Ô∏è"
        ]
      };

      async function handleBuyInterest(option) {
        appendMessage("user", option);
        const lower = option.toLowerCase();
        
        if (lower.includes("garantir as 50 receitas") || lower.includes("quero o b√°sico") || lower.includes("fico com o b√°sico") || 
            lower.includes("quero comprar as 50") || lower.includes("vou comprar as 50")) {
          currentPackage = 'basico';
          // Mostrar as mensagens personalizadas
          await simulateTyping(personalizedMessages.basico[0]);
          await simulateTyping(personalizedMessages.basico[1]);
          await simulateTyping(personalizedMessages.basico[2]);
          await showPaymentOptions();
        } 
        else if (lower.includes("quero o pacote completo") || lower.includes("quero o completo") || 
                 lower.includes("quero comprar o pacote completo") || lower.includes("vou comprar o pacote completo")) {
          currentPackage = 'completo';
          // Mostrar as mensagens personalizadas
          await simulateTyping(personalizedMessages.completo[0]);
          await simulateTyping(personalizedMessages.completo[1]);
          await simulateTyping(personalizedMessages.completo[2]);
          await showPaymentOptions();
        }
        else if (lower.includes("ver pacote b√°sico") || lower.includes("tenho d√∫vidas") || lower.includes("saber mais sobre as 50 receitas") || 
                 lower.includes("me explica sobre as 50 receitas") || lower.includes("detalhes das 50 receitas")) {
          currentPackage = 'basico';
          await show50ReceitasFlow();
        }
        else if (lower.includes("ver pacote completo") || lower.includes("detalhes completo") || lower.includes("saber mais sobre o pacote completo") || 
                 lower.includes("me explica sobre o pacote completo") || lower.includes("detalhes do pacote completo")) {
          currentPackage = 'completo';
          await showPacoteCompletoFlow();
        }
        else if (lower.includes("grupo free") || lower.includes("saber mais sobre o grupo") || lower.includes("detalhes do grupo")) {
          await handleOptionClick('Grupo Gr√°tis no WhatsApp');
        }
        else {
          // Se n√£o reconhecer, usa a Gemini para responder
          await handleCustomMessage(option);
        }
      }

      async function showPaymentOptions() {
        isWaitingPayment = true;
        comprovanteUploaded = false;
        
        const price = currentPackage === 'completo' ? '19,90' : '9,90';
        
        const pixInfoHTML = `
          <div class="pix-info">
            <p><strong>üìå Chave Pix (CPF):</strong> ${PIX_KEY}</p>
            <p><strong>üìå Nome:</strong> ${RECEIVER_NAME}</p>
            <p><strong>üü¢ Obs.:</strong> O nome que aparece √© do respons√°vel pelos pagamentos da minha equipe, t√° bom? Pode fazer tranquila(o), t√° tudo certinho!</p>
            <p><strong>üí∞ Valor:</strong> R$ ${price}</p>
            <div class="pdf-warning">
              <strong>üìÑ Aten√ß√£o:</strong> Voc√™ pode enviar o comprovante em imagem (JPG/PNG) ou em PDF. Assim que for verificado, os produtos ser√£o liberados automaticamente.
            </div>
          </div>
          <div class="comprovante-container">
            <div class="upload-buttons">
              <label for="uploadComprovanteFoto" class="upload-label">
                <img src="camera.webp" alt="Enviar imagem" />
                Enviar Comprovante em Foto
              </label>
              <label for="uploadComprovantePDF" class="upload-label">
                <img src="pdf-icon.webp" alt="Enviar PDF" />
                Enviar Comprovante em PDF
              </label>
            </div>
            <input type="file" accept="image/*" id="uploadComprovanteFoto" style="display: none" />
            <input type="file" accept=".pdf" id="uploadComprovantePDF" style="display: none" />
          </div>
        `;
        
        appendMessage("bot", pixInfoHTML);
        
        // Configurar os listeners para os uploads
        document.getElementById('uploadComprovanteFoto').addEventListener('change', function(e) {
          if (!comprovanteUploaded) {
            handleComprovanteUpload(e, 'image');
            comprovanteUploaded = true;
          }
        });
        
        document.getElementById('uploadComprovantePDF').addEventListener('change', function(e) {
          if (!comprovanteUploaded) {
            handleComprovanteUpload(e, 'pdf');
            comprovanteUploaded = true;
          }
        });
      }

      async function handleComprovanteUpload(event, type) {
        const file = event.target.files[0];
        if (!file) return;
        
        try {
          if (type === 'pdf') {
            // Processar PDF primeiro para mostrar o comprovante
            await processPDFComprovante(file);
          } else {
            // Processar imagem primeiro para mostrar o comprovante
            await processImageComprovante(file);
          }
          
          // S√ì DEPOIS de mostrar o comprovante, exibir a mensagem do bot
          appendMessage("bot", "üîÑ S√≥ um momento‚Ä¶<br>Estou validando seu pagamento. Assim que for confirmado, te libero o acesso! üòâ");
          
          showTypingIndicator();
          
          // Agora fazer a valida√ß√£o
          if (type === 'pdf') {
            const arrayBuffer = await file.arrayBuffer();
            const pdf = await pdfjsLib.getDocument(arrayBuffer).promise;
            let extractedText = '';
            
            for (let i = 1; i <= pdf.numPages; i++) {
              const page = await pdf.getPage(i);
              const textContent = await page.getTextContent();
              const strings = textContent.items.map(item => item.str);
              extractedText += strings.join(' ') + '\n';
            }
            
            await verifyComprovanteText(extractedText);
          } else {
            const reader = new FileReader();
            const imageData = await new Promise((resolve, reject) => {
              reader.onload = e => resolve(e.target.result);
              reader.onerror = reject;
              reader.readAsDataURL(file);
            });
            await verifyComprovante(imageData);
          }
        } catch (error) {
          console.error("Erro ao processar comprovante:", error);
          hideTypingIndicator();
          showComprovanteError();
        }
      }

      async function processImageComprovante(file) {
        const reader = new FileReader();
        return new Promise((resolve, reject) => {
          reader.onload = function(e) {
            uploadedComprovante = e.target.result;
            const previewHTML = `
              <div class="comprovante-container">
                <p>Comprovante enviado (imagem):</p>
                <img src="${uploadedComprovante}" class="comprovante-preview">
              </div>
            `;
            appendMessage("user", previewHTML);
            resolve();
          };
          reader.onerror = reject;
          reader.readAsDataURL(file);
        });
      }

      async function processPDFComprovante(file) {
        const arrayBuffer = await file.arrayBuffer();
        const pdf = await pdfjsLib.getDocument(arrayBuffer).promise;
        
        // Criar uma imagem da primeira p√°gina para mostrar como preview
        const page = await pdf.getPage(1);
        const viewport = page.getViewport({ scale: 1.0 });
        const canvas = document.createElement('canvas');
        const context = canvas.getContext('2d');
        canvas.height = viewport.height;
        canvas.width = viewport.width;
        
        await page.render({
          canvasContext: context,
          viewport: viewport
        }).promise;
        
        const previewImage = canvas.toDataURL('image/jpeg');
        uploadedComprovante = previewImage;
        
        // Mostrar preview do PDF
        const previewHTML = `
          <div class="comprovante-container">
            <p>Comprovante enviado (PDF):</p>
            <img src="${previewImage}" class="comprovante-preview">
          </div>
        `;
        appendMessage("user", previewHTML);
      }

      async function verifyComprovante(imageData) {
        try {
          const expectedAmount = currentPackage === 'completo' ? '19,90' : '9,90';
          
          const { data: { text } } = await Tesseract.recognize(
            imageData,
            'por',
            { logger: m => console.log(m) }
          );
          
          await verifyComprovanteText(text);
        } catch (error) {
          console.error("Erro ao verificar comprovante:", error);
          throw error;
        }
      }

      async function verifyComprovanteText(text) {
        hideTypingIndicator();
        
        const expectedAmount = currentPackage === 'completo' ? '19,90' : '9,90';
        
        // Verificar se o texto cont√©m qualquer uma das palavras-chave do nome do recebedor e o valor correto
        const normalizedText = text.toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g, '');
        const hasReceiverName = RECEIVER_KEYWORDS.some(keyword => normalizedText.includes(keyword));
        
        const hasCorrectAmount = text.includes(expectedAmount) || 
                               text.includes(expectedAmount.replace(',', '.')) || 
                               text.includes(`R$ ${expectedAmount}`) || 
                               text.includes(`R$${expectedAmount}`);
        
        if (hasReceiverName && hasCorrectAmount) {
          // Mostrar mensagem de sucesso
          const successHTML = `
            <div class="success-message">
              ‚úÖ Pagamento confirmado! Obrigada pela compra!
            </div>
            <p>Seu ${currentPackage === 'completo' ? 'Pacote Completo' : 'E-book com 50 receitas'} j√° est√° dispon√≠vel para download.</p>
            <p><strong>Link para download:</strong> <a href="${currentPackage === 'completo' ? EBOOK_COMPLETO_LINK : EBOOK_BASICO_LINK}" target="_blank">Clique aqui para acessar</a></p>
            <p><strong>Meu WhatsApp:</strong> <a href="https://wa.me/${WHATSAPP_LARISSA}" target="_blank">${formatPhoneNumber(WHATSAPP_LARISSA)}</a></p>
            ${currentPackage === 'completo' ? `<p><strong>Grupo exclusivo:</strong> <a href="${GRUPO_WHATSAPP}" target="_blank">Clique para entrar</a></p>` : ''}
            <p>Se precisar de algo, √© s√≥ chamar! üòä</p>
          `;
          appendMessage("bot", successHTML);
          
          // Adicionar o √°udio de agradecimento com o novo formato e delay
          const recordingEl = document.createElement("div");
          recordingEl.className = "bot-recording-indicator";
          recordingEl.innerHTML = `<img src="gravabot.webp" class="bot-recording-img">`;
          document.getElementById("chatBody").appendChild(recordingEl);
          document.getElementById("chatBody").scrollTop = document.getElementById("chatBody").scrollHeight;
          
          // Delay de 3 segundos simulando grava√ß√£o
          await new Promise(r => setTimeout(r, 3000));
          recordingEl.remove();
          
          // Mostrar o √°udio de agradecimento (sem reprodu√ß√£o autom√°tica)
          showAudioMessage(currentPackage === 'completo' ? audioAgradecimento2 : audioAgradecimento1);
        } else {
          showComprovanteError();
        }
      }

      function showAudioMessage(audio) {
        const audioHTML = `
          <div class="audio-message">
            <div class="play-button" onclick="toggleAudio(this)"></div>
            <div class="audio-info">
              <div class="audio-wave">
                ${Array.from({length: 50}, () =>
                  `<span style="height:${Math.random() * 20 + 5}px"></span>`
                ).join('')}
              </div>
            </div>
            <audio src="${audio.src}" style="display:none"></audio>
          </div>
        `;
        
        appendMessage("bot", audioHTML);
      }

      function showComprovanteError() {
        const expectedAmount = currentPackage === 'completo' ? '19,90' : '9,90';
        
        let errorMessage = '<div class="error-message">‚ùå N√£o consegui confirmar seu pagamento automaticamente</div>';
        errorMessage += '<p>Por favor, verifique se:</p>';
        errorMessage += '<ul>';
        errorMessage += '<li>Voc√™ enviou o comprovante do Pix para a chave <strong>' + PIX_KEY + '</strong> (CPF)</li>';
        errorMessage += '<li>O valor est√° correto: <strong>R$ ' + expectedAmount + '</strong></li>';
        errorMessage += '</ul>';
        errorMessage += '<p>Se j√° conferiu tudo e ainda assim n√£o foi validado, pode enviar novamente o comprovante?</p>';
        errorMessage += `
          <div class="comprovante-container">
            <div class="upload-buttons">
              <label for="uploadComprovanteFoto" class="upload-label">
                <img src="camera.webp" alt="Enviar imagem" />
                Enviar Comprovante em Foto
              </label>
              <label for="uploadComprovantePDF" class="upload-label">
                <img src="pdf-icon.webp" alt="Enviar PDF" />
                Enviar Comprovante em PDF
              </label>
            </div>
            <input type="file" accept="image/*" id="uploadComprovanteFoto" style="display: none" />
            <input type="file" accept=".pdf" id="uploadComprovantePDF" style="display: none" />
          </div>
        `;
        
        appendMessage("bot", errorMessage);
        
        // Configurar novamente os listeners
        comprovanteUploaded = false;
        document.getElementById('uploadComprovanteFoto').addEventListener('change', function(e) {
          if (!comprovanteUploaded) {
            handleComprovanteUpload(e, 'image');
            comprovanteUploaded = true;
          }
        });
        
        document.getElementById('uploadComprovantePDF').addEventListener('change', function(e) {
          if (!comprovanteUploaded) {
            handleComprovanteUpload(e, 'pdf');
            comprovanteUploaded = true;
          }
        });
      }

      function formatPhoneNumber(phone) {
        return phone.replace(/(\d{2})(\d{5})(\d{4})/, '($1) $2-$3');
      }

      function handleKeyPress(event) {
        if (event.key === 'Enter' && !isWaitingResponse) {
          sendMessage();
        }
      }

      async function sendMessage() {
        if (isWaitingResponse) return;
        const text = userInput.value.trim();
        if (!text) return;
        
        appendMessage("user", text);
        userInput.value = "";
        updateActionIcon();
        isWaitingResponse = true;
        showTypingIndicator();

        const lower = text.toLowerCase();
        const normalized = lower.normalize('NFD').replace(/[\u0300-\u036f]/g, '');

        // Verificar se est√° esperando n√∫mero do WhatsApp
        if (isWaitingWhatsappNumber) {
          hideTypingIndicator();
          isWaitingWhatsappNumber = false;
          
          // Validar n√∫mero de WhatsApp
          const whatsappNumber = text.replace(/\D/g, ''); // Remove tudo que n√£o for d√≠gito
          
          if (whatsappNumber.length === 11 && 
              whatsappNumber.charAt(2) === '9' && 
              /^\d+$/.test(whatsappNumber)) {
            
            // N√∫mero v√°lido - salvar no Google Sheets via Apps Script
            try {
              if (APP_SCRIPT_URL) {
                await fetch(`${APP_SCRIPT_URL}?whatsapp=${encodeURIComponent(`https://wa.me/${whatsappNumber}`)}`, {
                  method: 'GET'
                });
              }
              
              await simulateTyping("Perfeito! Assim que poss√≠vel, te adiciono no grupo, t√°? üíö‚ú®");
              
              appendMessage("bot", `
                <div class="option-buttons">
                  <button class="option-button" onclick="handleOptionClick('Me mostra o Pacote Completo')">üéÄ Me mostra o Pacote Completo</button>
                  <button class="option-button" onclick="handleOptionClick('As 50 Receitas')">üë©‚Äçüç≥ As 50 Receitas</button>
                </div>`);
            } catch (error) {
              console.error("Erro ao salvar n√∫mero:", error);
              await simulateTyping("O n√∫mero foi recebido, mas tive um problema t√©cnico para registrar. Pode me enviar de novo?");
              isWaitingWhatsappNumber = true;
            }
          } else {
            // N√∫mero inv√°lido
            await simulateTyping("Ops! O n√∫mero t√° com algum errinho... Me envia ele de novo com DDD e tudo junto, assim: 11999999999 üí¨");
            isWaitingWhatsappNumber = true;
          }
          
          isWaitingResponse = false;
          return;
        }

        // Perguntas sobre Larissa ou sobre o bot
        if (normalized.includes('quem e larissa') || normalized.includes('quem √© larissa') ||
            normalized.includes('quem e voce') || normalized.includes('quem √© voc√™') ||
            normalized.includes('quem e vc') || normalized.includes('quem √© vc') ||
            (normalized.includes('de onde') && normalized.includes('larissa')) ||
            normalized.includes('onde mora') || normalized.includes('onde vive') ||
            normalized.includes('vc √© de onde') || normalized.includes('voc√™ √© de onde')) {
          hideTypingIndicator();
          await showLarissaProfile();
          isWaitingResponse = false;
          return;
        }
        // Redes sociais
        if (normalized.includes('instagram') || normalized.includes('facebook') || normalized.includes('rede social') || normalized.includes('seguir')) {
          hideTypingIndicator();
          await simulateTyping("Siga-me:\nhttps://www.instagram.com/receitinhasdalari\nhttps://www.facebook.com/share/1ErC8vLffa/");
          if (currentPackage === 'completo') {
            appendMessage("bot", `
              <div class="option-buttons">
                <button class="option-button" onclick="handleOptionClick('As 50 Receitas')">üë©‚Äçüç≥ As 50 Receitas</button>
                <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
              </div>`);
          } else if (currentPackage === 'basico') {
            appendMessage("bot", `
              <div class="option-buttons">
                <button class="option-button" onclick="handleOptionClick('Me mostra o Pacote Completo')">üéÄ Me mostra o Pacote Completo</button>
                <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
              </div>`);
          } else {
            appendMessage("bot", `
              <div class="option-buttons">
                <button class="option-button" onclick="handleOptionClick('As 50 Receitas')">üë©‚Äçüç≥ As 50 Receitas</button>
                <button class="option-button" onclick="handleOptionClick('Me mostra o Pacote Completo')">üéÄ Me mostra o Pacote Completo</button>
                <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
              </div>`);
          }
          isWaitingResponse = false;
          return;
        }
        // Confiabilidade
        if (isTrustQuestion(text)) {
          hideTypingIndicator();
          await handleTrustQuestion(text);
          isWaitingResponse = false;
          return;
        }
        // Como comprar
        if (normalized.includes('como comprar') || normalized.includes('como faco para comprar') || normalized.includes('como fa√ßo para comprar') || normalized.includes('processo de compra') || normalized.includes('como funciona a compra')) {
          hideTypingIndicator();
          await showHowToBuy();
          isWaitingResponse = false;
          return;
        }
        // Sem gl√∫ten/lactose
        if (normalized.includes('celiaca') || normalized.includes('celiaco') ||
            (normalized.includes('intolerante') && (normalized.includes('lactose') || normalized.includes('gluten'))) ||
            normalized.includes('sem gl√∫ten') || normalized.includes('sem gluten') ||
            normalized.includes('sem lactose')) {
          hideTypingIndicator();
          await simulateTyping("Todas as receitas s√£o 100% sem gl√∫ten e sem lactose ‚Äî adequadas para intolerantes.");
          if (currentPackage === 'completo') {
            appendMessage("bot", `
              <div class="option-buttons">
                <button class="option-button" onclick="handleOptionClick('As 50 Receitas')">üë©‚Äçüç≥ As 50 Receitas</button>
                <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
              </div>`);
          } else if (currentPackage === 'basico') {
            appendMessage("bot", `
              <div class="option-buttons">
                <button class="option-button" onclick="handleOptionClick('Me mostra o Pacote Completo')">üéÄ Me mostra o Pacote Completo</button>
                <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
              </div>`);
          } else {
            appendMessage("bot", `
              <div class="option-buttons">
                <button class="option-button" onclick="handleOptionClick('As 50 Receitas')">üë©‚Äçüç≥ As 50 Receitas</button>
                <button class="option-button" onclick="handleOptionClick('Me mostra o Pacote Completo')">üéÄ Me mostra o Pacote Completo</button>
                <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
              </div>`);
          }
          isWaitingResponse = false;
          return;
        }
        // Pagamento/recebimento
        if ((normalized.includes('recebo') || normalized.includes('receber') || normalized.includes('quando recebo') ||
            normalized.includes('como recebo') || normalized.includes('envio do ebook') ||
            normalized.includes('pagamento') || normalized.includes('cobranca') ||
            normalized.includes('confirmar pagamento') || normalized.includes('recebimento'))) {
          hideTypingIndicator();
          if (currentPackage === 'completo') {
            await simulateTyping("Assim que seu pagamento for confirmado, te envio <strong>tudo aqui no chat</strong> mesmo! Voc√™ receber√°:<br>‚úîÔ∏è O link para baixar o <strong>Guide Completo com 125 Receitas + 6 B√¥nus</strong><br>‚úîÔ∏è Convite para o <strong>grupo exclusivo</strong> no WhatsApp<br>‚úîÔ∏è Meu contato direto para suporte<br><br>Fica tranquilo(a) que eu te guio passo a passo!");
          } else {
            await simulateTyping("Assim que seu pagamento for confirmado, vou te enviar <strong>tudo direto aqui no chat</strong>! Voc√™ receber√°:<br>‚úîÔ∏è O link para baixar seu <strong>E-book com 50 Receitas</strong> (em PDF)<br>‚úîÔ∏è Meu WhatsApp pessoal para tirar d√∫vidas<br><br>√â super r√°pido! Se o link n√£o aparecer em 2 minutinhos, me avisa que eu resolvo. üíõ");
          }
          if (currentPackage === 'completo') {
            appendMessage("bot", `
              <div class="option-buttons">
                <button class="option-button" onclick="handleOptionClick('As 50 Receitas')">üë©‚Äçüç≥ As 50 Receitas</button>
                <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
              </div>`);
          } else if (currentPackage === 'basico') {
            appendMessage("bot", `
              <div class="option-buttons">
                <button class="option-button" onclick="handleOptionClick('Me mostra o Pacote Completo')">üéÄ Me mostra o Pacote Completo</button>
                <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
              </div>`);
          } else {
            appendMessage("bot", `
              <div class="option-buttons">
                <button class="option-button" onclick="handleOptionClick('As 50 Receitas')">üë©‚Äçüç≥ As 50 Receitas</button>
                <button class="option-button" onclick="handleOptionClick('Me mostra o Pacote Completo')">üéÄ Me mostra o Pacote Completo</button>
                <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
              </div>`);
          }
          isWaitingResponse = false;
          return;
        }
        // Diferen√ßa entre e-books
        if (normalized.includes('diferenca') || normalized.includes('diferen√ßa') || normalized.includes('comparar') || normalized.includes('oq muda') || normalized.includes('oque muda') || normalized.includes('o que muda')) {
          hideTypingIndicator();
          await simulateTyping("B√°sico: 50 receitas sem gl√∫ten e lactose, acesso vital√≠cio, suporte. R$ 9,90. Completo: 125 receitas, comunidade, contato direto, atualiza√ß√µes e 6 b√¥nus. R$ 19,90.");
          if (currentPackage === 'completo') {
            appendMessage("bot", `
              <div class="option-buttons">
                <button class="option-button" onclick="handleOptionClick('As 50 Receitas')">üë©‚Äçüç≥ As 50 Receitas</button>
                <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
              </div>`);
          } else if (currentPackage === 'basico') {
            appendMessage("bot", `
              <div class="option-buttons">
                <button class="option-button" onclick="handleOptionClick('Me mostra o Pacote Completo')">üéÄ Me mostra o Pacote Completo</button>
                <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
              </div>`);
          } else {
            appendMessage("bot", `
              <div class="option-buttons">
                <button class="option-button" onclick="handleOptionClick('As 50 Receitas')">üë©‚Äçüç≥ As 50 Receitas</button>
                <button class="option-button" onclick="handleOptionClick('Me mostra o Pacote Completo')">üéÄ Me mostra o Pacote Completo</button>
                <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
              </div>`);
          }
          isWaitingResponse = false;
          return;
        }
        // Comunidade
        if (normalized.includes('comunidade') || normalized.includes('whatsapp') || normalized.includes('grupo') || normalized.includes('contato direto')) {
          hideTypingIndicator();
          await simulateTyping("No Pacote Completo voc√™ tem tanto a comunidade exclusiva quanto contato direto comigo via WhatsApp. Para participar, clique no bot√£o.");
          appendMessage("bot", `
            <div class="option-buttons">
              <button class="option-button" onclick="handleOptionClick('As 50 Receitas')">üë©‚Äçüç≥ As 50 Receitas</button>
              <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
            </div>`);
          isWaitingResponse = false;
          return;
        }
        // Acesso m√≥vel
        if ((normalized.includes('acessar') && normalized.includes('celular')) || normalized.includes('pelo celular') || normalized.includes('no cel')) {
          hideTypingIndicator();
          await simulateTyping("Voc√™ pode acessar tudo pelo celular, tablet ou computador.");
          if (currentPackage) {
            appendMessage("bot", `
              <div class="option-buttons">
                <button class="option-button" onclick="handleOptionClick('As 50 Receitas')">üë©‚Äçüç≥ As 50 Receitas</button>
                <button class="option-button" onclick="handleOptionClick('Me mostra o Pacote Completo')">üéÄ Me mostra o Pacote Completo</button>
                <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
              </div>`);
          } else {
            appendMessage("bot", `
              <div class="option-buttons">
                <button class="option-button" onclick="handleOptionClick('As 50 Receitas')">üë©‚Äçüç≥ As 50 Receitas</button>
                <button class="option-button" onclick="handleOptionClick('Me mostra o Pacote Completo')">üéÄ Me mostra o Pacote Completo</button>
                <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
              </div>`);
          }
          isWaitingResponse = false;
          return;
        }
        // Imprimir
        if (normalized.includes('imprimir') || normalized.includes('impressa')) {
          hideTypingIndicator();
          await simulateTyping("Os arquivos s√£o PDF e podem ser baixados e impressos.");
          if (currentPackage) {
            appendMessage("bot", `
              <div class="option-buttons">
                <button class="option-button" onclick="handleOptionClick('As 50 Receitas')">üë©‚Äçüç≥ As 50 Receitas</button>
                <button class="option-button" onclick="handleOptionClick('Me mostra o Pacote Completo')">üéÄ Me mostra o Pacote Completo</button>
                <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
              </div>`);
          } else {
            appendMessage("bot", `
              <div class="option-buttons">
                <button class="option-button" onclick="handleOptionClick('As 50 Receitas')">üë©‚Äçüç≥ As 50 Receitas</button>
                <button class="option-button" onclick="handleOptionClick('Me mostra o Pacote Completo')">üéÄ Me mostra o Pacote Completo</button>
                <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
              </div>`);
          }
          isWaitingResponse = false;
          return;
        }
        // Formas de pagamento
        if (normalized.includes('pix') || normalized.includes('boleto') || normalized.includes('cartao') || normalized.includes('forma de pagamento') || normalized.includes('parcelado') || normalized.includes('parcelamento')) {
          hideTypingIndicator();
          if (normalized.includes('parcelado') || normalized.includes('parcelamento')) {
            await simulateTyping("Eu n√£o aceito pagamento parcelado por j√° ser um valor de baixo custo e promocional. Aceito apenas PIX √† vista.");
          } else {
            await simulateTyping("Aceito apenas PIX √† vista. √â r√°pido, seguro e voc√™ pode pagar direto pelo seu app banc√°rio.");
          }
          if (currentPackage) {
            appendMessage("bot", `
              <div class="option-buttons">
                <button class="option-button" onclick="handleOptionClick('As 50 Receitas')">üë©‚Äçüç≥ As 50 Receitas</button>
                <button class="option-button" onclick="handleOptionClick('Me mostra o Pacote Completo')">üéÄ Me mostra o Pacote Completo</button>
                <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
              </div>`);
          } else {
            appendMessage("bot", `
              <div class="option-buttons">
                <button class="option-button" onclick="handleOptionClick('As 50 Receitas')">üë©‚Äçüç≥ As 50 Receitas</button>
                <button class="option-button" onclick="handleOptionClick('Me mostra o Pacote Completo')">üéÄ Me mostra o Pacote Completo</button>
                <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
              </div>`);
          }
          isWaitingResponse = false;
          return;
        }
        // E-books extras do completo
        if ((normalized.includes('6 ebooks') || normalized.includes('6 e-books') || normalized.includes('ebooks extras') || normalized.includes('extras pacote completo')) && normalized.includes('completo')) {
          hideTypingIndicator();
          await simulateTyping("S√£o 6 b√¥nus: doces sem a√ß√∫car, bolos sem gl√∫ten, panetones & chocotones, fermenta√ß√£o natural, substitui√ß√µes e p√£es tran√ßados.");
          appendMessage("bot", `
            <div class="option-buttons">
              <button class="option-button" onclick="handleOptionClick('As 50 Receitas')">üë©‚Äçüç≥ As 50 Receitas</button>
              <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
            </div>`);
          isWaitingResponse = false;
          return;
        }
        // Suporte t√©cnico
        if (normalized.includes('suporte') || normalized.includes('profissional') || normalized.includes('especialista')) {
          hideTypingIndicator();
          await simulateTyping("Suporte via WhatsApp: no B√°sico falo diretamente com voc√™; no Completo, al√©m do contato direto, voc√™ tamb√©m tem acesso √† comunidade exclusiva.");
          if (currentPackage === 'completo') {
            appendMessage("bot", `
              <div class="option-buttons">
                <button class="option-button" onclick="handleOptionClick('As 50 Receitas')">üë©‚Äçüç≥ As 50 Receitas</button>
                <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
              </div>`);
          } else {
            appendMessage("bot", `
              <div class="option-buttons">
                <button class="option-button" onclick="handleOptionClick('Me mostra o Pacote Completo')">üéÄ Me mostra o Pacote Completo</button>
                <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
              </div>`);
          }
          isWaitingResponse = false;
          return;
        }
        // Conte√∫do sem clicar bot√£o
        if ((normalized.includes('conteudo') || normalized.includes('o que tem') || normalized.includes('quais') || normalized.includes('oq vem') || normalized.includes('oque vem') || normalized.includes('oque tem')) &&
            normalized.includes('pacote completo')) {
          hideTypingIndicator();
          await showPacoteCompletoFlow();
          isWaitingResponse = false;
          return;
        }
        if ((normalized.includes('conteudo') || normalized.includes('o que tem') || normalized.includes('quais') || normalized.includes('oq vem') || normalized.includes('oque vem') || normalized.includes('oque tem')) &&
            (normalized.includes('50 receitas') || normalized.includes('ebook basico') || normalized.includes('basico'))) {
          hideTypingIndicator();
          await show50ReceitasFlow();
          isWaitingResponse = false;
          return;
        }
        // Interesse em ver fotos/exemplos das receitas
        if (normalized.includes('exemplo') || normalized.includes('amostra') || normalized.includes('foto') || 
            normalized.includes('imagem') || normalized.includes('ver como') || normalized.includes('como s√£o') ||
            normalized.includes('mostra') || normalized.includes('visualizar') || normalized.includes('visual')) {
          hideTypingIndicator();
          await simulateTyping("Claro! D√° uma olhadinha nessas del√≠cias que voc√™ vai aprender a fazer üòç");
          
          // Mostrar as imagens das receitas
          const imagesHTML = `
            <div style="margin-top: 10px;">
              <img src="pao1.webp" alt="P√£o de Milho de Frigideira" class="preview-image">
              <img src="pao2.webp" alt="P√£o de Batata na Airfryer" class="preview-image">
              <p>Olha s√≥ o que os nossos alunos est√£o dizendo‚Ä¶</p>
              <img src="depoimento.webp" alt="Depoimentos" class="testimonial-image">
              <p>Voc√™ pode confiar, esse conte√∫do j√° transformou a rotina de muita gente.</p>
            </div>
          `;
          appendMessage("bot", imagesHTML);
          
          if (currentPackage === 'completo') {
            appendMessage("bot", `
              <div class="option-buttons">
                <button class="option-button" onclick="handleOptionClick('As 50 Receitas')">üë©‚Äçüç≥ As 50 Receitas</button>
                <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
              </div>`);
          } else if (currentPackage === 'basico') {
            appendMessage("bot", `
              <div class="option-buttons">
                <button class="option-button" onclick="handleOptionClick('Me mostra o Pacote Completo')">üéÄ Me mostra o Pacote Completo</button>
                <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
              </div>`);
          } else {
            appendMessage("bot", `
              <div class="option-buttons">
                <button class="option-button" onclick="handleOptionClick('As 50 Receitas')">üë©‚Äçüç≥ As 50 Receitas</button>
                <button class="option-button" onclick="handleOptionClick('Me mostra o Pacote Completo')">üéÄ Me mostra o Pacote Completo</button>
                <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
              </div>`);
          }
          isWaitingResponse = false;
          return;
        }
        // Interesse direto
        const purchaseIntent = detectPurchaseIntent(text);
        if (purchaseIntent) {
          hideTypingIndicator();
          if (purchaseIntent.package === 'completo') {
            currentPackage = 'completo';
            await simulateTyping(personalizedMessages.completo[0]);
            await simulateTyping(personalizedMessages.completo[1]);
            await simulateTyping(personalizedMessages.completo[2]);
            await showPaymentOptions();
          } else {
            currentPackage = 'basico';
            await simulateTyping(personalizedMessages.basico[0]);
            await simulateTyping(personalizedMessages.basico[1]);
            await simulateTyping(personalizedMessages.basico[2]);
            await showPaymentOptions();
          }
          isWaitingResponse = false;
          return;
        }
        
        // Se n√£o for nenhum dos casos acima, usa a Gemini para responder
        hideTypingIndicator();
        await handleCustomMessage(text);
        isWaitingResponse = false;
      }

      function detectPurchaseIntent(message) {
        const lowerMsg = message.toLowerCase();
        
        // Verifica se √© uma pergunta sobre o produto (n√£o inten√ß√£o de compra)
        const isQuestion = lowerMsg.includes('?') || 
                          lowerMsg.includes('quais') || 
                          lowerMsg.includes('como') || 
                          lowerMsg.includes('quando') || 
                          lowerMsg.includes('onde') || 
                          lowerMsg.includes('por que') || 
                          lowerMsg.includes('porque') || 
                          lowerMsg.includes('explica') || 
                          lowerMsg.includes('detalhes') || 
                          lowerMsg.includes('saber mais');
        
        if (isQuestion) {
          return null; // N√£o √© inten√ß√£o de compra, √© pergunta sobre o produto
        }
        
        // Inten√ß√£o de compra clara
        if (lowerMsg.includes('quero o pacote completo') || lowerMsg.includes('125 receitas') || lowerMsg.includes('pacote completo') || lowerMsg.includes('vou ficar com o completo') || lowerMsg.includes('quero comprar o completo') || lowerMsg.includes('vou comprar o completo')) {
          return { package: 'completo' };
        }
        if (lowerMsg.includes('quero as 50 receitas') || lowerMsg.includes('ebook b√°sico') || lowerMsg.includes('50 receitas') || lowerMsg.includes('b√°sico') || lowerMsg.includes('basico') || lowerMsg.includes('vou ficar com as 50') || lowerMsg.includes('quero comprar as 50') || lowerMsg.includes('vou comprar as 50')) {
          return { package: 'basico' };
        }
        if (lowerMsg.includes('quero comprar') || lowerMsg.includes('adquirir') || lowerMsg.includes('garantir') || lowerMsg.includes('vou comprar')) {
          return { package: currentPackage || 'basico' };
        }
        return null;
      }

      function isTrustQuestion(message) {
        const lowerMsg = message.toLowerCase();
        return (
          lowerMsg.includes('confi√°vel') ||
          lowerMsg.includes('confiavel') ||
          lowerMsg.includes('golpe') ||
          lowerMsg.includes('seguro') ||
          lowerMsg.includes('verdade') ||
          lowerMsg.includes('mentira') ||
          lowerMsg.includes('depoimento') ||
          lowerMsg.includes('prova') ||
          lowerMsg.includes('real') ||
          lowerMsg.includes('credibilidade')
        );
      }

      async function handleTrustQuestion(message) {
        await simulateTyping("Pode ficar tranquila! Todos meus materiais s√£o digitais e entregues automaticamente ap√≥s a compra.");
        appendMessage("bot", `<img src="depoimento.webp" alt="Depoimentos" class="testimonial-image">`);
        await simulateTyping("Olha s√≥ o que os nossos alunos est√£o dizendo‚Ä¶ Voc√™ pode confiar, esse conte√∫do j√° transformou a rotina de muita gente.");
        if (conversationStage >= 1) {
          appendMessage("bot", `
            <div class="option-buttons">
              <button class="option-button" onclick="handleOptionClick('As 50 Receitas')">üë©‚Äçüç≥ As 50 Receitas</button>
              <button class="option-button" onclick="handleOptionClick('Me mostra o Pacote Completo')">üéÄ Me mostra o Pacote Completo</button>
              <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
            </div>`);
        } else {
          appendMessage("bot", `
            <div class="option-buttons">
              <button class="option-button" onclick="handleOptionClick('As 50 Receitas')">üë©‚Äçüç≥ As 50 Receitas</button>
              <button class="option-button" onclick="handleOptionClick('Me mostra o Pacote Completo')">üéÄ Me mostra o Pacote Completo</button>
              <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
            </div>`);
        }
      }

      async function showLarissaProfile() {
        const profileHTML = `
          <img src="larissa.webp" alt="Larissa Campos" class="profile-image">
          <p>Eu sou a Larissa Campos, nutricionista e chef de Florian√≥polis (SC). Minha paix√£o pela cozinha come√ßou por amor ‚Äî amor pela minha m√£e, que tem intoler√¢ncia √† lactose, e pelo meu irm√£o, que √© cel√≠aco.</p>
          <p>Crio receitas sem gl√∫ten e sem lactose que sejam simples, gostosas e acolhedoras, para ajudar pessoas a redescobrirem o prazer de comer bem.</p>
        `;
        await simulateTyping(profileHTML);
        if (conversationStage === 0) {
          appendMessage("bot", `
            <div class="option-buttons">
              <button class="option-button" onclick="handleOptionClick('As 50 Receitas')">üë©‚Äçüç≥ As 50 Receitas</button>
              <button class="option-button" onclick="handleOptionClick('Me mostra o Pacote Completo')">üéÄ Me mostra o Pacote Completo</button>
              <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
            </div>`);
        }
      }

      async function showHowToBuy() {
        await simulateTyping("<p>A compra √© bem simples e segura:</p><p>1. Escolha o e-book que deseja</p><p>2. Fa√ßa o pagamento via PIX para a chave <strong>98981420070</strong> (CPF)</p><p>3. Envie o comprovante aqui no chat</p><p>4. Ap√≥s confirma√ß√£o, voc√™ recebe acesso imediato ao material.</p><p>5. Se n√£o receber, verifique sua caixa de spam ou me avise.</p>");
        if (currentPackage) {
          appendMessage("bot", `
            <div class="option-buttons">
              <button class="option-button" onclick="handleOptionClick('As 50 Receitas')">üë©‚Äçüç≥ As 50 Receitas</button>
              <button class="option-button" onclick="handleOptionClick('Me mostra o Pacote Completo')">üéÄ Me mostra o Pacote Completo</button>
              <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
            </div>`);
        } else {
          appendMessage("bot", `
            <div class="option-buttons">
              <button class="option-button" onclick="handleOptionClick('As 50 Receitas')">üë©‚Äçüç≥ As 50 Receitas</button>
              <button class="option-button" onclick="handleOptionClick('Me mostra o Pacote Completo')">üéÄ Me mostra o Pacote Completo</button>
              <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
            </div>`);
        }
      }

      function showTypingIndicator() {
        if (!typingEl) {
          typingEl = document.createElement("div");
          typingEl.className = "typing-indicator";
          typingEl.innerHTML = "<span></span><span></span><span></span>";
          document.getElementById("chatBody").appendChild(typingEl);
          document.getElementById("chatBody").scrollTop = document.getElementById("chatBody").scrollHeight;
        }
      }

      function hideTypingIndicator() {
        if (typingEl) {
          typingEl.remove();
          typingEl = null;
        }
      }

      async function simulateTyping(message, delay = 1500) {
        // Calcular tempo de digita√ß√£o baseado no tamanho da mensagem
        const typingTime = Math.min(Math.max(message.length * 30, 1500), 5000);
        showTypingIndicator();
        await new Promise(r => setTimeout(r, typingTime));
        hideTypingIndicator();
        if (message) {
          appendMessage("bot", message);
        }
      }

      function appendMessage(sender, message) {
        const chatBody = document.getElementById("chatBody");
        const msgEl = document.createElement("div");
        msgEl.className = `message ${sender}`;
        msgEl.innerHTML = message;
        chatBody.appendChild(msgEl);
        chatBody.scrollTop = chatBody.scrollHeight;
      }

      async function handleCustomMessage(text) {
        const systemPrompt = buildSystemPrompt(text);
        const finalPrompt = systemPrompt + "\n\nCliente: " + text;
        try {
          showTypingIndicator();
          const res = await fetch(`${GEMINI_URL}?key=${GEMINI_API_KEY}`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              contents: [{ parts: [{ text: finalPrompt }] }]
            })
          });
          const data = await res.json();
          hideTypingIndicator();
          let reply = "N√£o entendi. Pode reformular?";
          if (!data.error && data.candidates && data.candidates[0] && data.candidates[0].content && data.candidates[0].content.parts[0].text) {
            reply = data.candidates[0].content.parts[0].text.trim();
            // Remover poss√≠veis prefixos "Larissa:" ou "Cliente:" que a IA possa ter adicionado
            reply = reply.replace(/^(Larissa:|Cliente:)\s*/i, '');
          }
          await simulateTyping(reply);
          const postIntent = detectPurchaseIntent(reply);
          if (postIntent) {
            if (postIntent.package === 'completo') {
              currentPackage = 'completo';
              appendMessage("bot", `
                <div class="option-buttons">
                  <button class="option-button" onclick="handleOptionClick('Me mostra o Pacote Completo')">üéÄ Me mostra o Pacote Completo</button>
                  <button class="option-button" onclick="handleOptionClick('As 50 Receitas')">üë©‚Äçüç≥ As 50 Receitas</button>
                </div>`);
            } else {
              currentPackage = 'basico';
              appendMessage("bot", `
                <div class="option-buttons">
                  <button class="option-button" onclick="handleOptionClick('Me mostra o Pacote Completo')">üéÄ Me mostra o Pacote Completo</button>
                  <button class="option-button" onclick="handleOptionClick('As 50 Receitas')">üë©‚Äçüç≥ As 50 Receitas</button>
                </div>`);
            }
          }
        } catch (err) {
          hideTypingIndicator();
          appendMessage("bot", "Erro ao processar. Tente novamente.");
          appendMessage("bot", `
            <div class="option-buttons">
              <button class="option-button" onclick="handleOptionClick('As 50 Receitas')">üë©‚Äçüç≥ As 50 Receitas</button>
              <button class="option-button" onclick="handleOptionClick('Me mostra o Pacote Completo')">üéÄ Me mostra o Pacote Completo</button>
              <button class="option-button" onclick="handleOptionClick('Grupo Gr√°tis no WhatsApp')">üíö Grupo Gr√°tis no WhatsApp</button>
            </div>`);
        }
      }
    </script>
  </body>
</html>
